<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>Адмін - Просто поговори</title>
  <style>
    body { font-family: Arial, sans-serif; background:#eef2f3; margin:0; padding:0; }
    #chat { list-style:none; padding:10px; margin:0; height:70vh; overflow-y:auto; background:white; }
    #chat li { padding:8px 12px; margin-bottom:8px; border-radius:8px; max-width:70%; }
    .admin { background:#cfe2ff; margin-left:auto; }
    .user { background:#e2e3e5; margin-right:auto; }
    #form { display:flex; padding:10px; background:#fff; border-top:1px solid #ccc; }
    #input { flex-grow:1; padding:10px; border:1px solid #ccc; border-radius:6px; }
    button { padding:10px 15px; border:none; border-radius:6px; background:#198754; color:#fff; margin-left:5px; cursor:pointer; }
    button:hover { background:#157347; }
    #container { display:flex; flex-direction:column; height:100vh; }
  </style>
</head>
<body>
<div id="container">
  <ul id="chat"></ul>
  <form id="form">
    <input id="input" autocomplete="off" placeholder="Напишіть відповідь..." />
    <button>Відправити</button>
  </form>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const form = document.getElementById("form");
  const input = document.getElementById("input");
  const chat = document.getElementById("chat");

  function addMessage(from, text) {
    const item = document.createElement("li");
    if (from === "admin") {
      item.classList.add("admin");
      item.textContent = "Я (адмін): " + text;
    } else {
      item.classList.add("user");
      item.textContent = "Користувач: " + text;
    }
    chat.appendChild(item);
    chat.scrollTop = chat.scrollHeight;
  }

  // отримуємо історію при вході
  socket.on("chat history", (messages) => {
    messages.forEach(msg => addMessage(msg.from, msg.text));
  });

  // отримуємо нові повідомлення
  socket.on("chat message", (data) => {
    addMessage(data.from, data.text);
  });

  // надсилаємо повідомлення
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    if (input.value) {
      socket.emit("chat message", { from: "admin", text: input.value });
      input.value = "";
    }
  });
</script>
</body>
</html>
