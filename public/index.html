<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>–ü—Ä–æ—Å—Ç–æ –ø–æ–≥–æ–≤–æ—Ä–∏</title>
  <style>
    body { font-family: Arial, sans-serif; background:#f0f2f5; margin:0; padding:0; }
    #chat { list-style:none; padding:10px; margin:0; height:70vh; overflow-y:auto; background:white; }
    #chat li { padding:8px 12px; margin-bottom:8px; border-radius:8px; max-width:70%; }
    .me { background:#d1e7dd; align-self:flex-end; margin-left:auto; }
    .friend { background:#f8d7da; align-self:flex-start; margin-right:auto; }
    #form { display:flex; padding:10px; background:#fff; border-top:1px solid #ccc; }
    #input { flex-grow:1; padding:10px; border:1px solid #ccc; border-radius:6px; }
    button { padding:10px 15px; border:none; border-radius:6px; background:#0d6efd; color:#fff; margin-left:5px; cursor:pointer; }
    button:hover { background:#0b5ed7; }
    #container { display:flex; flex-direction:column; height:100vh; }
  </style>
</head>
<body>
<div id="container">
  <ul id="chat"></ul>
  <form id="form">
    <input id="input" autocomplete="off" placeholder="–ù–∞–ø–∏—à—ñ—Ç—å –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è..." />
    <button>–ù–∞–¥—ñ—Å–ª–∞—Ç–∏</button>
  </form>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
  const socket = io();
  const form = document.getElementById("form");
  const input = document.getElementById("input");
  const chat = document.getElementById("chat");

  function addMessage(from, text) {
    const item = document.createElement("li");
    if (from === "admin") {
      item.classList.add("friend");
      item.textContent = "–î—Ä—É–≥ üíô: " + text;
    } else {
      item.classList.add("me");
      item.textContent = "–Ø: " + text;
    }
    chat.appendChild(item);
    chat.scrollTop = chat.scrollHeight;
  }

  // –æ—Ç—Ä–∏–º—É—î–º–æ —ñ—Å—Ç–æ—Ä—ñ—é –ø—Ä–∏ –≤—Ö–æ–¥—ñ
  socket.on("chat history", (messages) => {
    messages.forEach(msg => addMessage(msg.from, msg.text));
  });

  // –æ—Ç—Ä–∏–º—É—î–º–æ –Ω–æ–≤—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  socket.on("chat message", (data) => {
    addMessage(data.from, data.text);
  });

  // –Ω–∞–¥—Å–∏–ª–∞—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    if (input.value) {
      socket.emit("chat message", { from: "user", text: input.value });
      input.value = "";
    }
  });
</script>
</body>
</html>
